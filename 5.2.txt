5.2 Docker Compose Structure
Docker Compose Services Overview (hyphen based)
traefik
- Exposed ports: 80, 443
- Volume: traefik-certificates
- Network: tarodan-network
web (Next.js Public Application)
- Build context: apps/web/Dockerfile
- Internal port: 3000
- Replicas: 2
- Environment: NEXT_PUBLIC_API_URL
- Traefik labels enabled for tarodan.com
admin (Next.js Admin Panel)
- Build context: apps/admin/Dockerfile
- Internal port: 3002
- Replicas: 1
- Traefik labels enabled for admin.tarodan.com
api (NestJS API)
- Build context: apps/api/Dockerfile
- Internal port: 3001
- Replicas: 2
- Depends on: postgres, redis, elasticsearch, minio
- Traefik labels enabled for api.tarodan.com
worker (BullMQ Background Workers)
- Build context: apps/api/Dockerfile
- Startup command: node dist/workers/main.js
- Replicas: 2
- Depends on: redis, postgres, minio
postgres
- Image: postgres:16-alpine
- Internal port: 5432
- Volume: postgres-data
- Resources: 2 CPU, 4 GB RAM
redis
- Image: redis:7-alpine
- Internal port: 6379
- Volume: redis-data
- Persistence: appendonly enabled
elasticsearch
- Image: elasticsearch:8.12.0
- Internal port: 9200
- Volume: elasticsearch-data
- Resources: 2 CPU, 2 GB RAM
minio
- Image: minio/minio:latest
- Ports: 9000 (S3 API), 9001 (Console)
- Volume: minio-data
- Traefik labels enabled for storage.tarodan.com and minio.tarodan.com
prometheus
- Image: prom/prometheus:latest
- Internal port: 9090
- Volumes: prometheus-data, configuration
- Scrape targets: api, postgres, redis
grafana
- Image: grafana/grafana:latest
- Internal port: 3003
- Volumes: grafana-data, dashboards
- Traefik labels enabled for grafana.tarodan.com
loki
- Image: grafana/loki:latest
- Internal port: 3100
- Volume: loki-data
Plain Text Explanation
The Docker Compose configuration defines all application, infrastructure, and monitoring services required
to run the platform in a containerized environment. Traefik serves as the entry point, handling HTTPS
traffic and routing requests to internal services based on domain rules. Public-facing applications such as
the web and admin panels are exposed only through Traefik and run on internal ports. The API and
background worker services handle business logic and asynchronous processing, while core data services
like PostgreSQL, Redis, Elasticsearch, and MinIO are isolated within the internal Docker network and
never exposed publicly. Monitoring and observability are handled by Prometheus, Grafana, and Loki,
providing metrics, dashboards, and centralized logging. This structure ensures clear separation of
concerns, secure internal networking, horizontal scalability through replicas, and operational visibility
across the entire system.