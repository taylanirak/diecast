4.2 Core Tables and Relationships
Structured Relationships (hyphen based)
users (1) → products (N)
- Relationship valid only when is_seller = true
products (1) → product_images (N)
products (1) → offers (N)
users (buyer) (1) → offers (N)
offers (1) → orders (1) [optional]
products (1) → orders (N)
users (buyer) (1) → orders (N)
users (seller) (1) → orders (N)
orders (1) → payments (1)
payments (1) → payment_holds (1)
orders (1) → shipments (1)
shipments (1) → shipment_events (N)
users (1) → admin_users (1) [optional]
admin_users (1) → audit_logs (N)
commission_rules (N) → categories (1) [optional]
Plain Text Explanation
The core table relationships define how entities interact within the marketplace data model. A user can
own multiple products when marked as a seller, and each product can have multiple images and offers
associated with it. Buyers may submit multiple offers, and an offer may optionally result in a single order if
it is accepted. Orders act as the central transactional entity, connecting buyers, sellers, products, and
offers. Each order is associated with exactly one payment and one shipment, while shipments may have
multiple shipment events to track delivery progress. Payment holds provide escrow support by linking
payments to sellers until release conditions are met. Administrative relationships are modeled separately.
A user may optionally have an admin profile, and all administrative actions are tracked through audit logs.
Commission rules may optionally be linked to product categories to support flexible and prioritized
commission calculation strategies.